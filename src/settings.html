
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel='stylesheet' href='styles.css' type='text/css' media='screen' />
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>
    <title>Imperial to Metric Converter Settings</title>
    <style type="text/css">
        /*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
        html{color:#000;background:#FFF;}
        body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,button,textarea,p,blockquote,th,td{margin:0;padding:0;}
        table{border-collapse:collapse;border-spacing:0;}
        fieldset,img{border:0;}
        address,caption,cite,code,dfn,em,strong,th,var,optgroup{font-style:inherit;font-weight:inherit;}
        del,ins{text-decoration:none;}
        li{list-style:none;}
        caption,th{text-align:left;}
        h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}
        q:before,q:after{content:'';}
        abbr,acronym{border:0;font-variant:normal;}
        sup{vertical-align:baseline;}
        sub{vertical-align:baseline;}
        legend{color:#000;}
        input,button,textarea,select,optgroup,option{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;}
        input,button,textarea,select{font-size:100%;}

        /*
        * Some Element Styles
        */
        h1{
            color:#fff;
            font-size:30px;
        }
        h2{
            margin-top:15px;
            font-size:19px;
            color:#333;
        }
        h3{
            font-size:12px;
            margin-top:15px;
            color:#666;
        }
        p{
            margin-bottom:9px;

        }
        a{
            color:inherit;
            text-decoration:none;
        }
        a:hover{
            text-decoration:underline;
        }



        /*
            Some "Mobile" styles
            And other general styles
        */

        .not-there{
            display:none;
        }
        .head{
            background:#333;
            padding: 10px 0 5px 10px;
            height:40px;
        }

        .foot{
            margin:10px 0 0 0;
            padding:10px 10px 10px 10px;
            border-top:solid 1px #999;
            background:#333;
            color:#fff;
        }
        .pg-main{
            padding: 0 10px 0 10px;
        }

        .units {
            margin: 5px 0 5px 0;
        }

        .units li {
            padding: 5px;
        }

        input {
            margin-right: 10px;
        }

        .btn-primary {
            color: #fff;
            background-color: #337ab7;
            border-color: #2e6da4;
        }
        .btn {
            display: inline-block;
            padding: 6px 12px;
            margin-bottom: 0;
            font-size: 14px;
            font-weight: 400;
            line-height: 1.42857143;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            -ms-touch-action: manipulation;
            touch-action: manipulation;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            background-image: none;
            border: 1px solid transparent;
            border-radius: 4px;
        }
        button, input, select, textarea {
            font-family: inherit;
            font-size: inherit;
            line-height: inherit;
        }
        button, html input[type=button], input[type=reset], input[type=submit] {
            -webkit-appearance: button;
            cursor: pointer;
        }
        button, select {
            text-transform: none;
        }
        button {
            overflow: visible;
        }
        button, input, optgroup, select, textarea {
            margin: 0;
            font: inherit;
            color: inherit;
        }
        * {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }

        #save {
            margin: 10px;
            display: block;
            width: 100%;
        }

        /*
            The "Desktop" layout
        */
        @media all and (min-width:800px){
            .pg{
                width:800px;
                margin:0 auto;
            }
            .pg-main{
                float:left;
                width:100%;
                padding:0;
            }
            .head{
                float:left;
                width:790px;
                height:40px;
                padding:160px 0 0 10px;
                margin:10px 0 0 0;
                -webkit-box-shadow:0px 0px 7px #999;
                -moz-box-shadow:0px 0px 7px #999;
                -o-box-shadow:0px 0px 7px #999;
                box-shadow:0px 0px 7px #999;

                -webkit-border-radius:0 0 10px 10px;
                -moz-border-radius:0 0 10px 10px;
                -o-border-radius:0 0 10px 10px;
                border-radius:0 0 10px 10px;
            }
            .entries{
                float:left;
                width:680px;
                padding: 0 20px 0 0;

            }
            .entries p {
                display:block;
            }

            .foot{
                float:left;
                width:100%;
                padding:30px 0 10px 0;
                margin:0;
                color:#000;
                background:transparent;
            }
        }
    </style>
</head>
<body>

<div class='pg'>
    <div class='head'>
        <h1><a href='#'>Visible Units</a></h1>
    </div>

    <div class='pg-main'>

        <div class='entries'>
        </div>
        <button class="btn btn-primary" id="save">Save</button>
    </div>

    <div class='foot'>
        <p>&copy; Greg Lockwood 2015</p>
    </div>
</div>
<script src="data.js"></script>
<script>
    var data = config_data;
    var chosen_units = data.menu_sections[0].units.concat(data.menu_sections[1].units);
    if ('Settings' in this) {
        var existing_value = Settings.option('chosen_units');
        if (existing_value)
            chosen_units = existing_value;
    }

    document.addEventListener('DOMContentLoaded', function () {
        var entries = document.getElementsByClassName('entries')[0];
        for (var i = 0, len = data.menu_sections.length; i < len; i++) {
            var menu_section = data.menu_sections[i];
            var h2 = document.createElement('h2');
            h2.textContent = menu_section.title;
            entries.appendChild(h2);
            var ul = document.createElement('ul');
            ul.className = "units";
            ul.section = i;
            for (var j = 0, jlen = menu_section.units.length; j < jlen; j++) {
                var unit_pair = menu_section.units[j],
                        parts = unit_pair.split('_'),
                        from = data.units[parts[0]],
                        to = data.units[parts[1]];
                var li = document.createElement('li');
                var cb = document.createElement('input');
                cb.type = "checkbox";
                cb.name = unit_pair;
                if (chosen_units.indexOf(unit_pair) > -1)
                    cb.setAttribute('checked', true);
                var label = document.createElement('label');
                label.appendChild(cb);
                label.innerHTML += from.text + ' to ' + to.text;
                li.appendChild(label);
                ul.appendChild(li);
            }
            entries.appendChild(ul);
        }
    });

    document.addEventListener('change', function () {
        var checkboxes = document.getElementsByTagName('input');
        chosen_units = [];
        for (var i = 0, len = checkboxes.length; i < len; i++) {
            if (checkboxes[i].checked)
                chosen_units.push(checkboxes[i].name);
        }
        console.log('chosen_units updated to ', chosen_units);
    });

    document.getElementById('save').addEventListener('click', function () {
        var options = {chosen_units: chosen_units};
        document.location = 'pebblejs://close#' + encodeURIComponent(JSON.stringify(options));
    });
</script>
</body>
</html>